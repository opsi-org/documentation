////
; Copyright (c) uib GmbH (www.uib.de)
; This documentation is owned by uib
; and published under the german creative commons by-sa license
; see:
; https://creativecommons.org/licenses/by-sa/3.0/de/
; https://creativecommons.org/licenses/by-sa/3.0/de/legalcode
; english:
; https://creativecommons.org/licenses/by-sa/3.0/
; https://creativecommons.org/licenses/by-sa/3.0/legalcode
;
; credits: https://www.opsi.org/credits/
////

:Author:    uib GmbH
:Email:     info@uib.de
:Date:      30.04.2024
:Revision:  4.3
:toclevels: 6
:doctype:   book
:icons:     font
:xrefstyle: full

include::common:partial$opsi_terms.adoc[]

[[opsi-manual-configed-clients]]
= Clients

This chapter introduces client management with `opsi-configed` and the features available after clicking the _Client Configuration_ button in the top right overview. You will learn, among other things, how to search for specific clients and retrieve additional information like session data, how to create and manage clients and client groups, execute remote control commands, send pop-up messages, and more.

[[opsi-manual-configed-client-selection]]
== Searching Clients

After you have successfully logged in, the _Clients_ tab in the center of the main window is activated. Here you see a list of clients that belong to the currently selected depot or the selection in the left sidebar (see section <<opsi-manual-configed-treeview>>). Right-clicking on the selected clients opens a context menu through which you can perform various actions, such as triggering events, sending messages, shutting down, and restarting, etc.

.*opsi-configed*: Context Menu after right-clicking a Client
image::opsi-configed-clientselection.png["*opsi-configed*: Context Menu after Right-clicking a Client", width=800, pdfwidth=80%]

At the top, there's a search box where you can enter a string. Right next to it, you decide through a drop-down menu where `opsi-configed` should search: in all columns (meaning all columns that are displayed in the current configuration), by client name, description, status (on/off), date (last seen), and by IP address. The _Mode_ drop-down menu further refines the search:

* _Full-text search_: Use the search just as you would on search engines, entering one or more search words separated by spaces. For a successful search result, at least one of your keywords must appear in one of the columns.

* _Start-text search_: Begin your search with the string that you want to find at the start of an entry in a column.

* _Regular expression_: Enter the search term as a regular expression to find rows where the text in a column matches patterns as defined in the rules of regular expressions. For details on these patterns, please see the Java documentation for `java.util.regex.Pattern`.

When you press the [Enter] key after entering your search expression, `opsi-configed` jumps to the next match (or to the next line if there is no match). Right-click in the search box to display additional options.

.*opsi-configed*: Client Search
image::opsi-configed-clientselection-search.png["*opsi-configed*: Client Search", width=800, pdfwidth=80%]

=== Examples of Search Patterns

TIP: Below are a few examples of simple and complex search patterns.

If you want to search for the string "Meyer" in the names or descriptions of PCs, you can use the pattern `.*eyer.*`. Here, the dot (`.`) represents any character, and the asterisk (`*`) represents any number of occurrences (of the preceding element). `.*eyer.*` means the search pattern matches as long as there is something before `eyer` and something follows it. As any number of occurrences also includes no occurrence, the string "PC Meyer" would match, for example.

NOTE: To ensure that strings like "Beyer" aren't also found, the search pattern should be better specified as `.*[Mm]eyer.*`. The square brackets mean that exactly one of the listed characters (either an `M` or an `m`) must be present.

The second example demonstrates search patterns for products. `0.-opsi.*standard` looks for all product names starting with `0`, followed by any character, followed by `-opsi`, followed by any characters (in any number); ending with `standard`. If you want to ensure that the second character is a digit between `0` and `9`, then use this expression: `0[0123456789]-opsi.*standard`. As a shortcut for `[0123456789]`, you can also write `[0-9]`, as it represents a continuous subsequence of the sequence of all digits. This search pattern would match products such as `03-opsi-abo-standard` and `05_opsi-linux_standard`, for example.

[[opsi-manual-configed-client-selection-table]]
== Listing Clients

The table on the _Clients_ tab shows the following columns by default:

* _Client name_: Displays the FQDN, i.e. the client's hostname and the domain name. 

* _Description_: This column may contain an optional description.

* _On_: The column shows which clients are currently connected. To do this, click on the second icon from the right at the top left of the icon group. You can activate this feature on the login screen or via a command line parameter. By default, the test interval is set to 0 minutes, which means that this function is deactivated.

.*opsi-configed*: Client can be reached.
image::opsi-configed-client-erreichbar.png["Client can be reached.", width=20]

.*opsi-configed*: Client cannot be reached.
image::opsi-configed-client-nicht-erreichbar.png["Client cannot be reached.", width=20]

.*opsi-configed*: Use this Icon to check which Clients are connected.
image::configed_toolbar_icons_connected.png["*opsi-configed*: Use this icon to check which clients are connected.", pdfwidth=80%]

* _Last seen_: Here you can see the date and time at which the client last reported to the software distribution via the `opsiconfd` service.

* _IP address_: Displays the client's IP address.

Click on a column title to reverse the order. Optionally, you can show additional columns by right-clicking on the table and opening the _Visible columns_ entry in the context menu. Now select the columns that you would also like to show: _WAN Configuration_, _System UUID_, _MAC address_, _Session information_, _Inventory number_, _Creation date_, _Install on shutdown_ and _depot_.

TIP: To permanently display the additional columns in `opsi-configed`, use the top right icon to change to the server configuration (see the chapter xref:gui:configed/userguide-server.adoc[Server]) and open the _Host parameters_ tab. Edit the _configed_ / _configed.host_displayfields_ option accordingly.

.*opsi-configed*: Configure the visible Columns in the Client List.
image::opsi-configed-config-host-displayfields.png["*opsi-configed*: Configure the visible Columns in the Client List.", width=800, pdfwidth=80%]

If you add the column _Session information_, the button _Request session information from all clients_ in the icon group at the top left is activated.

.*opsi-configed*: Use this Icon to request Session Information from all Clients.
image::configed_toolbar_icons_sessioninfo.png["*opsi-configed*: Use this Icon to request Session Information from all Clients.", pdfwidth=80%]

When you press the button, the `opsiconfd` attempts to establish a connection with all clients and gather information about currently active user sessions. In the _Session information_ column, you will then see the account name of each active session. You can also activate this function specifically for selected clients via the context menu or the _Client_ menu. This helps to avoid unnecessary waiting for network timeouts if it tries to connect to computers that are turned off.

TIP: Since the search function for the client list includes all columns, you can also use it to search for clients where a specific user is logged in.

[[opsi-manual-configed-client-selection-selecting]]
== Selecting Clients

You can select one or several clients in the client list to edit them together. Use the funnel icon or go through the menu _Selection_ / _Show only selected clients_ to limit the list to your selected clients.

.*opsi-configed*: Use this Icon to only show selected Clients.
image::configed_toolbar_icons_filter.png["*opsi-configed*: Use this Icon to only show selected Clients.", pdfwidth=80%]

TIP: You can add the selected clients to an existing group by dragging and dropping them onto a group name in the left sidebar.

Using the third icon from the left or through the _Selection_ menu, you can start the free client search dialog, where you can search based on client and/or product properties.

.*opsi-configed*: Use the Free Client Search to create your own Search Criteria.
image::configed_clientselection.png["*opsi-configed*: Use the Free Client Search to create your own Search Criteria.", pdfwidth=80%]

You can conduct your search for clients not only based on general host properties but also using hardware and software components as search criteria, regardless of whether they were installed via opsi or another method. Use the asterisk (`*`) as a wildcard for any text input. Link your search criteria with logical `AND` or `OR`. Exclude certain results by prefixing a criterion with `NOT`.

To add more criteria to your search, use the _Add criterion_ dropdown menu. Remove an unwanted criterion by clicking the trash bin icon on the right edge. To reset the search form to its initial state, simply click _New search_.

You can save your queries under any name and later retrieve them via _Selection_ / _Saved search queries_. Adding a description when saving will display it as a tooltip in the dropdown list, helping you recall the contents of the saved search.

.*opsi-configed*: Saved Search Queries
image::configed_clientselection2.png["*opsi-configed*: Saved Search Queries", pdfwidth=80%]

NOTE: If new clients have been added to the environment between searches that match the saved search criteria, `opsi-configed` will also find them.

TIP: You can pass a saved search to `opsi-configed` at startup using the command line option `-qs` (see section xref:gui:configed/userguide.adoc#opsi-configed-start-parameters[Start Parameters]). If you omit the name, the command will output a list of the saved queries.

Through the _Selection_ menu, you can also specifically search for clients with failed actions, either related to a product or within a specific timeframe.

.*opsi-configed*: Search for Failed Actions.
image::opsi-configed-failedactions-today.png["*opsi-configed*: Search for Failed Actions.", width=800, pdfwidth=80%]

[[opsi-manual-configed-treeview]]
== Grouping Clients 

Using the tree view on the left panel, you can manage your clients in groups. The view is divided into three categories: _GROUPS_, _DIRECTORY_, and _CLIENT LIST_. The latter automatically displays all clients from the selected depots. The first two sections differ in how often a client can appear in them. A group is uniquely defined by its name and cannot be duplicated, whereas a client can be assigned to multiple groups. In the _DIRECTORY_ branch, each client has a unique place: unless explicitly assigned to a subgroup, the client is automatically listed in the _UNASSIGNED_ group.

NOTE: When a client is selected, all groups to which it belongs are highlighted with a colored background.

.*opsi-configed*: Tree View
image::opsi-configed-treeview.png["*opsi-configed*: Tree View", pdfwidth=80%]

The tree view offers the following features:

* Click on a tree node, such as a group, to display all clients under this node in the middle on the _Clients_ tab. No client is selected for editing.

* If you want to mark individual clients for editing, click them directly in the tree view or select them with the mouse ([Ctrl]{plus}Click or [Shift]{plus}Click).

* Double-clicking on a group not only displays the associated clients in the table but also selects them for editing at the same time.

TIP: This is especially useful when you are working on various tabs, for instance, if you have the _Log files_ tab open and want to view logs for specific clients only.

=== Creating New Groups

You can easily create additional groups. Simply right-click on the parent group or node, such as _GROUPS_, and select _Create subgroup_.

.*opsi-configed*: Create a new Group.
image::opsi-configed-treeview-generate-group.png["*opsi-configed*: Create a new Group.", pdfwidth=80%]

A dialog box then opens where you can enter a name and description for the new group.

.*opsi-configed*: Enter Group Name and Description.
image::opsi-configed-treeview-groupname.png["*opsi-configed*: Enter Group Name and Description.", pdfwidth=80%]

=== Adding Clients to Groups

There are several ways to add or move clients to groups via drag and drop (see the section <<opsi-manual-configed-client-selection-selecting>>):

* Drag clients directly from the client list (tab _Clients_) to a group to add them.

* If you want to copy clients, drag them from a "normal" group, e.g., from the _CLIENT LIST_ node, to another group.

* To move a client, drag them from one _DIRECTORY_ group to another _DIRECTORY_ group.

=== Editing Groups

Right-click on a group to open a context menu. This menu offers options to edit or delete the group, select all clients contained within, and recursively remove all clients from the group and any subgroups.

[[opsi-manual-configed-client-editing]]
== Editing Clients

Right-click on the client list (tab _Clients_) or open the _Client_ menu to display possible operations for opsi clients. In the main window, you also see a dialog on the right where you can configure a few properties and extensions for the client.

.*opsi-configed*: The *Client* Menu
image::opsi-configed-client-contextmenu.png["*opsi-configed*: The *Client* Menu", pdfwidth=80%]

[[opsi-manual-configed-module-uefi-wan-installbyShutdown]]
=== Install on Shutdown, UEFI, and WAN

You can make some settings in the field next to the client list. These include options like _Install on shutdown (Windows)_, _UEFI Boot_, and _WAN configuration_.

The Linux client agent is a xref:opsi-modules:linux.adoc[paid extension]. This means that you need an activation file to unlock it. You will receive this file after you have purchased the extension. For evaluation purposes, we're happy to provide you with a temporary license free of charge. Please contact us via mailto:info@uib.de[email].


NOTE: The WAN/VPN extension is a xref:opsi-modules:wan-support.adoc[paid extension]. This means that you need an activation file to unlock it. You will receive this file after you have purchased the extension. For evaluation purposes, we're happy to provide you with a temporary license free of charge. Please contact us via mailto:info@uib.de[email].

* _Install on shutdown (Windows)_: There's a well-established process to configure installations upon the shutdown of a client (see the chapter xref:opsi-modules:on-shutdown.adoc[opsi Installation on Shutdown (free)]).

* _UEFI Boot_: Configures a client for UEFI boot (see the chapter xref:opsi-modules:uefi.adoc[opsi with UEFI/GPT])

* _WAN configuration_: Enables the xref:opsi-modules:wan-support.adoc[WAN/VPN extension]; if the module is not available, the checkbox appears grayed out.

The WAN configuration is read from the server host parameters `configed.meta_config.wan_mode_off.*`. If you have adopted the default settings of the parameters, the recommended configuration described in the chapter xref:opsi-modules:wan-support.adoc[WAN/VPN Extension] applies.

TIP: You can display information about the options _Install on shutdown (Windows)_ and _WAN configuration_ as a column in the client list, either via the right-click context menu or through the _Client_ / _Visible columns_ menu. This way, you can directly see in the overview which clients have these properties set, and you can filter and sort accordingly.

.*opsi-configed*: Extended Column View for opsi Clients
image::opsi-configed-clientinfos.png["*opsi-configed*: Extended Column View for opsi Clients", width=800, pdfwidth=80%]

[[opsi-manual-configed-host-actions-wakeonlan]]
=== Wake on LAN (WoL)

`opsi-configed` includes a scheduler for Wake-On-LAN events (WOL), which you can set up via the menu _Client_ / _"Wake up" client(s)_ / _New scheduler_. From version 4.0.7, the WOL feature offers the following configuration options:

* Direct sending of the network signal to all selected clients.
* Delayed transmission of the signal with an adjustable interval between two clients.
* Setting a start time for the process via a scheduler.

If a client is assigned to a depot server other than the opsi config server, the transmission of the Wake-on-LAN signal does not occur directly. In this case, an HTTPS connection to the `opsiconfd` on the depot server is established. The depot server is then responsible for sending the network packet within its network.

.*opsi-configed*: Scheduler for Wake on LAN (WoL)
image::opsi-configed-wake-on-lan-scheduler.png["opsi-configed: Scheduler for Wake on LAN (WoL)", pdfwidth=80%]

NOTE: Please be aware that `opsi-configed` triggers the Wake-On-LAN actions. Therefore, it is crucial that the program remains active throughout the process and is not terminated.

[[opsi-manual-configed-host-actions-opsiclientd-event]]
=== Triggering Events (Push Installation)

Under _Client_ / _Trigger opsiclientd event_ / _on_demand_, you can send a call to the client agent of all selected clients to trigger an event. If a client is unreachable or is currently processing another non-interruptible event, `opsi-configed` will display an error message.

The default event is `on_demand`. This ensures that action requests for the client are executed immediately.

CAUTION: If a product script includes a reboot request, the client will be restarted without warning.

Since version 4.0.4, it is also possible to trigger other events configured in the `opsiclientd.conf` file. The available options are determined by the server host parameter `configed.opsiclientd_events`.

[[opsi-configed-host-actions-delete-package-caches]]
=== WAN Clients: Deleting Package Cache

For clients connected over a Wide Area Network (WAN), issues with the package cache can occasionally arise. To address these difficulties, a special function is available for these clients: Menu _Client_ / _For WAN clients: clear package caches_ completely resets the cache.

=== Sending Messages

You can send messages to one or several clients. Select them and then open _Client_ from the menu and choose _Send pop-up message_. In the dialog box that opens, type your message. In the top right field, you can enter the desired display duration; leave the field empty to display the message indefinitely.

.*opsi-configed*: Send a message to Client(s).
image::opsi-configed-client-message-editing.png["*opsi-configed*: Send a message to Client(s).", pdfwidth=80%]

Click on the red checkmark to send the message.

.*opsi-configed*: Client message window
image::opsi-configed-client-message-reading.png["*opsi-configed*: Client message window", pdfwidth=80%, width=800]

[[opsi-manual-configed-client-editing-sessioninfo]]
=== Requesting Session Information

Through the _Client_ menu, you can send a signal to selected clients prompting them to submit their session information to `opsi-configed`. This information will be displayed in the designated column on the _Clients_ tab, provided that this column is enabled and visible.

[[opsi-manual-configed-client-editing-shutdown]]
=== Shutdown/Reboot

You have the option to send a signal to selected clients instructing them to shut down or reboot.

CAUTION: Please be aware that clients may shut down without further inquiry, which can lead to data loss if there are unsaved data or active processes on the client.

[[opsi-manual-configed-client-remotecontrol]]
=== Starting Remote Control Software

Using the _Client_ menu / _Launch Remote Control Software_ (key [F7]) or the right-click context menu, you can execute any operating system commands on the selected clients. By default, there are four entries that serve as templates for your own commands: sending a `ping` command to Linux and Windows clients, as well as displaying the info page on Windows and Linux (see the section xref:clients:windows-client/windows-client-agent.adoc#opsi-manual-clientagent-infopage[*opsiclientd* Info Page]).

.*opsi-configed*: Starting Remote Control Software
image::opsi-configed-client-remotecontrol-choice.png["*opsi-configed*: Starting Remote Control Software", pdfwidth=80%]

NOTE: Please note that `opsi-configed` executes these commands from its own system environment. This means that the type of command required depends on whether you are running `opsi-configed` on Windows or Linux.

The dialog is divided into three areas:

1. In the top area, you will find a list of the names of the available commands.
2. Below that is a line showing the selected command. Here, you can edit the command if allowed. This line also includes buttons to start and abort the action.
3. In the third text area of the window, any system feedback from the command execution is displayed.

The applications of this feature are extremely diverse. For example, you can configure a command to establish a remote desktop connection to the selected client, provided that the client supports it. On Windows, you could use the following command for this purpose:

[source,console]
----
cmd.exe /c start mstsc /v:%host%
----

A corresponding Linux command is like this:

[source,console]
----
rdesktop  -a 16 %host%
----

`opsi-configed` automatically replaces `%host%` with the corresponding value for the host name. In addition to `%host%`, there are other variables available that you can use in the commands:

* `%ipaddress%`: IP address
* `%hardwareaddress%`: MAC address
* `%opsihostkey%`: opsi host key
* `%inventorynumber%`: Inventory number
* `%depotid%`: Depot ID
* `%configserverid%`: Config server ID

You can edit the commands in the server configuration on the _Host parameters_ tab, _configed_ / _remote_control_:

.*opsi-configed*: Configure the Remote Control Commands.
image::opsi-configed-properties-remotecontrol.png["*opsi-configed*: Configure the Remote Control Commands.", width=800, pdfwidth=80%]

TIP: If a command has the `.editable` attribute set to `true`, you can enter variations of the command in the displayed command line, including options or passwords.

CAUTION: This gives the `opsi-configed` user the ability to freely extend a command and execute all possible commands on the client.

==== Eigenes Remote-Control-Kommando definieren

Um ein eigenes Kommando zu definieren, wechseln Sie in der Server-Konfiguration zum Reiter _Host-Parameter_, Abteilung _configed_ / _remote_control_. Im Beispiel richten wir ein Kommando namens `example` ein. Sie benötigen dazu mindestens den Eintrag `configed.remote_control.example` (oder alternativ `configed.remote_control.example.command`). In diesem Eintrag legen Sie den auszuführenden Befehl fest und verwenden dazu die im letzten Abschnitt gezeigten Variablen, z.{nbsp}B. `%host%`, `%ipaddress%` usw.

Zusätzlich können Sie einen Eintrag `configed.remote_control.example.description` erstellen und das neue Kommando erläutern. Der Wert dieses Eintrags wird dann als Tooltip angezeigt, um den Benutzern weitere Informationen über das Kommando zu liefern.

Darüber hinaus bestimmen Sie mit einem booleschen Eintrag `configed.remote_control.example.editable`, ob das Kommando editierbar sein soll oder nicht. Durch Setzen dieses Wertes auf `false` wird festgelegt, dass Benutzer das Kommando beim Aufruf nicht verändern dürfen.

[[opsi-manual-configed-client-add]]
=== Client(s) anlegen

Über _Client_ / _Neuen opsi-Client erstellen_ öffnen Sie ein Dialogfenster, in das Sie alle Informationen zum Anlegen eines neuen Clients eingeben.

.*opsi-configed*: Neuen Client anlegen
image::opsi-configed-client-new.png["*opsi-configed*: Neuen Client anlegen", width=800, pdfwidth=80%]

Der Dialog bietet auch Felder für die optionale Eingabe der IP-Nummer und der Hardware-Adresse (MAC-Adresse). Sofern das Backend zur Konfiguration eines lokalen DHCP-Servers aktiviert ist (was nicht die Standardeinstellung ist), werden diese Informationen verwendet, um den neuen Client auch für den DHCP-Server zu registrieren. Andernfalls wird die MAC-Adresse im Backend gespeichert und die IP-Nummer verworfen.

Beim Anlegen neuer Clients können Sie ab `opsi-configed` 4.0.5.8.1 darüber hinaus diese Optionen direkt spezifizieren:

* Zuweisung des neuen Clients zu einer bestimmten Gruppe
* Festlegung eines Netboot-Produkts, das eventuell direkt auf `setup` gesetzt werden soll
* Aktivierung von Install on Shutdown und der WAN-Konfiguration

Diese Einstellungen lassen sich auch bequem in der Hosts-Liste vornehmen.

==== Mehrere Clients erstellen

Klicken Sie im Dialog zur Client-Erzeugung auf die Schaltfläche _Template_ ganz oben, um ein CSV-Template zu erzeugen. Wählen Sie per Klick in die Checkboxen die gewünschten Daten aus, die Sie einbeziehen möchten. Auch das Escape- und das Trennzeichen können Sie in diesem Dialogfenster definieren. Klicken Sie abschließend auf _OK_, um die CSV-Datei zu erzeugen.

Diese können Sie anschließend mit einem Texteditor oder einer Tabellenkalkulation bearbeiten, um eine Liste von Clients mit ihren jeweiligen Eigenschaften zu erstellen. Sie können die Liste über den Button _Datei_ neben _CSV-Datei importieren_ im Dialog zur Client-Erstellung einlesen.

.*opsi-configed*: Mehrere Clients anlegen
image::opsi-configed-csv.png["*opsi-configed*: Mehrere Clients anlegen", pdfwidth=80%]

==== Erstellen/Löschen deaktivieren

Seit Version 4.0.4 besteht zudem die Möglichkeit, die Optionen zum Anlegen und Löschen von Clients zu deaktivieren. Das ist dann praktisch, wenn ein Dienst wie ein UCS-Service für das Anlegen von Clients zuständig ist. Um diese Funktion einzurichten, bearbeiten Sie in der Server-Konfiguration den Host-Parameter `configed.host_actions_disabled`. Klicken Sie in die Spalte; der nächste Dialog bietet diese drei Optionen:

* `add client`
* `free licenses for client`
* `remove client`

Eine Mehrfachauswahl ist möglich.

TIP: Sie können die Einstellungen nicht nur im `opsi-configed` ändern, sondern auch auf der Kommandozeile. Geben Sie den folgenden Befehl ein, um das Erstellen und Löschen von Clients über den `opsi-configed` zu deaktivieren.

[source,console]
----
opsi-admin -d method config_updateObjects '{"defaultValues": ["add client", "remove client"], "editable": false, "multiValue": true, "possibleValues": ["add client", "remove client"], "type": "UnicodeConfig", "id": "configed.host_actions_disabled"}'
----

=== Client(s) umbenennen und umziehen

Über das Menü _Client_ erreichen Sie ebenfalls Einträge zum Umbenennen und zum Umziehen in ein anderes Depot. Letzteres erlaubt eine Mehrfachauswahl von Clients. Im folgenden Dialogfenster wählen Sie aus dem Drop-down-Menü das gewünschte Depot aus und bestätigen anschließend alles über _OK_.

.*opsi-configed*: Client(s) in anderes Depot bewegen
image::opsi-configed-client-change-depot.png["*opsi-configed*: Client(s) in anderes Depot bewegen", pdfwidth=80%]

=== Client(s) löschen

Wählen Sie einen oder mehrere Clients aus und öffnen dann aus dem Menü _Client_ / _Lösche Client(s)_. Ein Dialog mit einer Sicherheitsabfrage öffnet sich, und Sie müssen explizit bestätigen, dass Sie den Client aus der opsi-Datenbank entfernen möchten.

[[opsi-manual-configed-client-editing-productreset]]
=== Produkte zurücksetzen

Sie können alle Informationen zu allen Produkten der ausgewählten Clients löschen. Das ist beispielsweie dann sinnvoll, wenn Sie einen Testclient in einen bestimmten Zustand zurücksetzen möchten.

[[opsi-manual-configed-productconfiguration]]
== Localboot-Produkte

Wenn Sie auf den Reiter _Localboot-Produkte_ wechseln, erhalten Sie eine umfassende Liste der zur Softwareverteilung verfügbaren Produkte sowie Informationen zum Installations- und Aktionsstatus bezogen auf die ausgewählten Clients.

In der rechten Seitenleiste finden Sie zusätzliche hilfreiche Informationen zum ausgewählten Produkt, wie den Produktnamen und die -version. Die Felder für Produktinformationen und -beschreibung unterstützen die Darstellung von Markdown. Das ist besonders dann nützlich ist, wenn Sie in der `control.toml`-Datei beim Erstellen des Produktes verwendet haben (siehe Abschnitt xref:clients:windows-client/softwareintegration.adoc#opsi-softwintegration-example-control[Beispiel: *control*-Datei]).

Darüber hinaus führt eine Tabelle eventuelle Produktabhängigkeiten auf und zeigt dazu detaillierte Eigenschaften und eine Baumstruktur an, welche die Abhängigkeiten rekursiv visualisiert. So erkennen Sie nicht nur, welche anderen Produkte das ausgewählte Produkt benötigt, sondern auch, von welchen Produkten es benötigt wird. Diese Funktion ist besonders hilfreich, wenn Sie beispielsweise vor dem Entfernen eines Produkts überprüfen möchten, ob es noch von anderen Produkten benötigt wird.

.*opsi-configed*: Liste der Localboot-Produkte mit Detailansicht rechts
image::opsi-configed-localbootproducts.png["*opsi-configed*: Liste der Localboot-Produkte mit Detailansicht rechts", width=800, pdfwidth=80%]

TIP: Genau wie in der Client-Liste können Sie das Suchfeld über der Tabelle dazu verwenden, nach Namen und nach anderen Werten in der Tabelle zu suchen. Rechts neben dem Suchfeld finden Sie Filter. Weitere Informationen dazu lesen Sie in Abschnitt <<opsi-manual-configed-client-selection>>.

=== Liste sortieren

Genau wie in der Client-Liste können Sie die Anzeige über einen Klick auf den Spaltentitel beeinflussen. Es sind die folgenden Spalten verfügbar:

* _Produkt-ID_: Hier steht der Name des Produktes.
* _Status_: Zeigt den letzten der Softwareverteilung gemeldeten Status zu diesem Produkt ( _installed_, _not_installed_ oder _undefined_) an. _not_installed_ wird aus Gründen der Übersichtlichkeit nicht angezeigt. _undefined_ ist üblicherweise der Status während einer (De-)Installation oder wenn das letzte Skript gescheitert ist.
* _Bericht_: Hier sehen Sie eine Zusammenfassung der Werte der internen Statusinformationen `actionProgress` (Installationsfortschritt), `actionResult` (Ergebnis der letzten Aktion) und `lastAction` (letzte angeforderte Aktion). Während einer Installation steht hier z.{nbsp}B. `installing`. Nach Abschluss einer Aktion zeigt das Feld das Ergebnis, z.{nbsp}B. `success (setup)` oder `failed (setup)`.
* _Angeforderte Aktion_: Hier steht die Aktion, die ausgeführt werden soll. Mögliche Werte sind `none` (visuell ist das Feld leer), `setup`, `uninstall`, `update`, `once`, `always` und `custom`.
* _Version_: Die Versionsnummer ist eine Kombination aus Produktversion und Paketversion des auf dem Client installierten opsi-Softwareproduktes.

Über das Kontextmenü der rechten Maustaste und _Sichtbare Spalten_ blenden Sie zusätzliche Spalten für die Localboot-Produkte ein:

* _Produktname_: Hier steht der Name der Anwendung.
* _Sollzustand_: Der Sollzustand, mögliche Werte: `undefined`, `installed`, `always` und `forbidden`.
* _Priorität_: Gibt an, welche Priorität dem Produkt zugeordnet wurde; mögliche Werte `100` bis `-100`.
* _Position_: Hier steht, in welcher Reihenfolge die Produkte installiert werden.
* _Letzte Status-Aktualisierung_: Zeitpunkt der letzten Aktualisierung

[[opsi-manual-configed-property-details]]
=== Detaillierte Informationen anzeigen

Wenn Sie ein Produkt auswählen, erscheinen auf der rechten Seite des Fensters weitere Informationen:

* _Software/Paketversion_: Hier steht eine Kombination aus Produkt- und Paketversion, wie sie der Paketierer angegeben hat.

* _Produktbeschreibung_: Freier Text zur im Paket enthaltenen Software.

* _Hinweise_: Freier Text mit Angaben zum Umgang mit diesem Paket.

* _Produktabhängigkeiten_: Eine Liste von Produkten, zu denen das ausgewählte Produkt Abhängigkeiten aufweist mit Angabe der Art der Abhängigkeit: `required` (das ausgewählte Produkt benötigt das hier angezeigte Produkt, Reihenfolge der Installation egal), `pre-required` (das hier angezeigte Produkt muss *vor* dem ausgewählten installiert werden) und `post-required` (das hier angezeigte Produkt muss *nach* dem ausgewählten installiert werden).

* _Property-Konfiguration_: Zur clientspezifischen Anpassung der Installation können für ein Produkt zusätzliche Propertys definiert sein; der nächste Abschnitt beschreibt diese Property-Tabellen.

[[opsi-manual-configed-property-editing]]
=== Property-Konfiguration

Eine Property-Tabelle besteht aus zwei Spalten. In der linken Spalte finden Sie die Namen der Propertys und in der rechten Spalte den jeweils zugeordneten Wert.

NOTE: Die Zeilen, die von den Standardwerten (Server-Defaults) abweichen, sind in Fettschrift dargestellt. So sehen Sie auf einen Blick, wo Einstellungen angepasst wurden.

Rechts oben über der Tabelle befinden sich zwei Buttons:

* _Client-Werte auf Server-Defaults setzen_ (links): Dieser Button kopiert die Server-Defaults als clientspezifische Einstellungen. So bleiben diese Einstellungen auch dann beim Client erhalten, wenn später die Standardwerte geändert werden.

* _Clientspezifische Werte entfernen_ (rechts): Dieser Button löscht alle Einstellungen auf dem Client; danach gelten wieder die Server-Defaults. Änderungen an diesen Standardwerten wirken sich somit direkt auf den Client aus.

Wenn Sie mit dem Mauszeiger über eine Zeile fahren, wird (sofern konfiguriert) ein Tooltip eingeblendet. Dieser zeigt nützliche Informationen zur Bedeutung des Wertes sowie den Server-Default an.

.*opsi-configed*: Property-Tabelle
image::opsi-configed-editlist1.png["*opsi-configed*: Property-Tabelle", pdfwidth=80%]

Klicken Sie einen Wert in der rechten Spalte an, um einen Dialog zur Bearbeitung zu öffnen. Hier können Sie z.{nbsp}B. aus einer Liste vorkonfigurierter Werte aussuchen.

.*opsi-configed*: Listen-Editor, Auswahlliste
image::opsi-configed-editlist2.png["*opsi-configed*: Listen-Editor, Auswahlliste", pdfwidth=80%]

Klicken Sie einen (anderen) Wert im Dialog an, um die Einstellung zu verändern.

Zusätzlich zu diesen Dialogen, gibt es auch Fenster, die ein Bearbeitungsfeld anzeigen. Hier können Sie neue Werte eingeben:

.*opsi-configed*: Listen-Editor, Feld für eigene Werte
image::opsi-configed-editlist3.png["*opsi-configed*: Listen-Editor, Feld für eigene Werte", pdfwidth=80%]

Um einen vorhandenen Wert zu modifizieren, doppelklicken Sie ihn in der Liste. Neue Werte übernehmen Sie per Klick auf das Pluszeichen in die Liste. Bei einigen Propertys ist es möglich, mehrere Werte einzutragen. In dem Fall erlaubt der Listen-Editor auch eine Mehrfachauswahl. Mehrere Einträge können Sie bequem auswählen, wenn Sie beim Mausklick die [Strg]-Taste gedrückt halten.

Sobald Sie die Werte in der Liste verändert haben, wechselt im Dialog der grüne Haken seine Farbe. Klicken Sie auf das nun rote Häkchen, um Ihre Änderjngen zu übernehmen. Andernfalls klicken Sie auf den blauen Abbrechen-Button, um die Änderungen zurückzusetzen.

[[opsi-manual-configed-property-editing-secrects]]
== Geheime Property-Werte

Für den Fall, dass Passwörter oder andere "Geheimnisse" als Property-Werte vorkommen,
ist folgende Vorkehrung getroffen (als "Hack" seit Version 4.0.7, bis ein spezifischer Datentyp eingerichtet ist):

* Wenn im Namen des Properties irgendwo 'password' vorkommt
* oder wenn der Property-Name mit 'secret' ("geheim" oder "Geheimnis") beginnt,

wird der Property-Wert bei der Anzeige durch fünf  _*_  ersetzt. Er wird erst - nach Vorwarnung - sichtbar gemacht, wenn er wie zur Bearbeitung angeklickt wird.

Die Bearbeitung findet ggfs. wie im Standardfall statt.

[[opsi-manual-configed-netbootproducts]]
== Netboot-Produkte

Die Produkte unter dem Karteireiter _Netboot-Produkte_ werden analog zum Karteireiter _Localboot-Produkte_ angezeigt und konfiguriert.

Die hier angeführten Produkte versuchen, werden sie auf _setup_ gestellt, zu den ausgewählten Clients den Start von Bootimages beim nächsten Reboot festzulegen.
Dies dient üblicherweise der OS-Installation.

.*opsi-configed*: Liste der Netboot-Produkte mit Detailansicht rechts
image::opsi-configed-netbootproducts.png["*opsi-configed*: Liste der Netboot-Produkte mit Detailansicht rechts", width=800, pdfwidth=80%]

[[opsi-manual-configed-hardwareinformation]]
== Hardware-Informationen

Unter diesem Karteireiter erhalten Sie die letzten - entweder durch das Bootimage oder durch das Localboot-Produkt hwaudit
erhobenen - Hardware-Informationen zum ausgewählten Client.

.*opsi-configed*: Reiter Hardware-Information
image::opsi-configed-hardwareinformation.png["*opsi-configed*: Reiter Hardware-Information", width=800, pdfwidth=80%]


[[opsi-manual-configed-automat-treiberintegration]]
=== Integrating Drivers automatically

Um vereinfacht und automatisiert Treiber von speziellen Clients auf den _opsi-Depotserver_ zu uploaden, gibt es seit
der Version 4.0.5 die Möglichkeit aus den Hardwareinformationen mögliche Pfade auszuwählen, die vom opsi-configed über den Share
übertragen werden.
Die zwei angebotenen byAudit-Treiberpfade setzten sich zusammen aus dem Hersteller und dem Produkt bzw. dem Modell, welche jeweils aus dem Computer und der Hauptplatine ausgelesen werden. Betätigen Sie den Button _Treiberupload_, so erscheint ein neues Fenster um weitere Einstellungen zu tätigen.

.*opsi-configed*: Hardware-Information, Treiberupload
image::opsi-configed-hardwareinfo-treiberintegration.png["*opsi-configed*: Hardware-Information, Treiberupload", width=800, pdfwidth=80%]

Haben Sie den _opsi-configed_ auf einem Linux-System geöffnet, so ist es nicht direkt möglich einen Treiberupload durchzuführen, da die Verbindung über einen Share durchgeführt wird. Dies muss dann manuell getätigt werden. Jedoch sind die Methoden bzw. Verzeichnisstrukturen ein wesentlicher Aspekt der Treiberintegration.

Ohne weiteres funktioniert der Treiberupload von einem Windows-Rechner, wenn die Verbindung zum Share aktiviert ist.
Unter anderem müssen im neues Fenster Angaben getätigt werden, für welches Windows-Produkt der Treiber bereit gestellt
werden soll, welche Treiber geuploadet werden sollen und mit welcher Methode bzw. in welches Verzeichnis die Treiberintegration erfolgt. Das Zielverzeichnis wird mit Auswählen einer anderen Methode dem entsprechend geändert. Der zuvor ausgewählte byAudit-Treiberpfad findet sich in der per Default ausgewählten Methode 'byAudit' wieder, die den ausgewählten Treiber spezifisch für den Maschinentyp integriert.
Folgende Methoden bzw. Verzeichnisse sind möglich:

 * _Standard_: Treiber welche im Verzeichnis `./drivers/drivers` liegen, werden anhand der PCI-Kennungen (bzw. USB- oder HD_Audio-Kennung) in der Beschreibungsdatei des Treibers als zur Hardware passend erkannt und in das Windows Setup mit eingebunden. Der Nachteil dieser Pakete ist, das sich hier auch Treiber finden, welche zwar von der Beschreibung zu Ihrer Hardware passen, aber nicht unbedingt mit Ihrer Hardware funktionieren. Hier können Treiber hinterlegt werden, die einen Fallback für alle Clients darstellen.

 * _Preferred_: Zusätzliche bzw. geprüfte Treiber gehören in jeweils eigene Verzeichnisse (Name und Tiefe der Verzeichnisstruktur egal) unterhalb des Verzeichnisses `./drivers/drivers/preferred`. Treiber welche im Verzeichnis `./drivers/drivers/preferred` liegen, werden gegenüber den Treibern in `./drivers/drivers` bevorzugt anhand der PCI-Kennungen (bzw. USB- oder HD_Audio-Kennung) in der Beschreibungsdatei des Treibers als zur Hardware passend erkannt und in das Windows Setup mit eingebunden. Finden sich z.B. zu ein und derselben PCI-ID unterschiedliche Treiber unter `preferred`, so kann dies zu Problemen bei der Treiber Zuordnung führen. In diesem Fall ist eine direkte Zuordnung der Treiber zu den Geräten notwendig.

 * _Preferred_: Zusätzliche bzw. geprüfte Treiber gehören in jeweils eigene Verzeichnisse (Name und Tiefe der Verzeichnisstruktur egal) unterhalb des Verzeichnisses `./drivers/drivers/preferred`. Treiber welche im Verzeichnis `./drivers/drivers/preferred` liegen, werden gegenüber den Treibern in `./drivers/drivers` bevorzugt anhand der PCI-Kennungen (bzw. USB- oder HD_Audio-Kennung) in der Beschreibungsdatei des Treibers als zur Hardware passend erkannt und in das Windows Setup mit eingebunden. Finden sich z.B. zu ein und derselben PCI-ID unterschiedliche Treiber unter `preferred`, so kann dies zu Problemen bei der Treiber Zuordnung führen. In diesem Fall ist eine direkte Zuordnung der Treiber zu den Geräten notwendig.

 * _Excluded_: Es kann vorkommen, das Treiberverzeichnisse von Herstellern Treiber für unterschiedliche Betriebssystemversionen (Vista / Win7) oder Konfigurationen (SATA / SATA-Raid) enthalten. Wenn Sie die Vermutung haben, das ein verlinkter Treiber falsch ist, so verschieben Sie diesen Treiber in das Verzeichnis `drivers/exclude` und führen `create_driver_links.py` erneut aus. Treiber die in `drivers/exclude` liegen werden bei der Treiberintegration nicht berücksichtigt.

 * _Additional_: Zusätzliche Treiber, die unabhängig von ihrer Zuordnung bzw. Erkennung über die PCI- oder USB-IDs installiert werden sollen, gehören in jeweils eigene Verzeichnisse (Name und Tiefe der Verzeichnisstruktur egal) unterhalb des Verzeichnisses `./drivers/drivers/additional`. Über das Produkt-Property 'additional_drivers' können Sie einen oder mehrere Pfade von Treiberverzeichnissen innerhalb von `./drivers/drivers/additional` einem Client zu ordnen. Im Produkt-Property 'additional_drivers' angegebene Verzeichnisse werden rekursiv durchsucht und alle enthaltenen Treiber eingebunden. Dabei wird auch symbolischen Links gefolgt. Dies können Sie nutzen, um für bestimmte Rechner-Typen ein Verzeichnis zu erstellen (z.B. dell-optiplex-815).

 * _byAudit_: In dem Verzeichnis `./drivers/drivers/additional/byAudit/<Vendor>/<Model>` hinterlegte Treiber, werden bei einer Windows-Installation nach einem Verzeichnisnamen durchsucht, der dem bei der Hardware-Inventarisierung gefundenen 'Vendor' entspricht. In diesem 'Vendor' Verzeichnis wird nun nach einem Verzeichnisnamen gesucht, das dem bei der Hardware-Inventarisierung gefundenen 'Model' entspricht. Wird ein solche Verzeichnis gefunden, so wird diese Verzeichnis genauso behandelt, als wären sie über das Produktproperty 'additional_drivers' manuell zugewiesen.



Einige Hersteller verwenden Modellbezeichnungen, die für diese Methode sehr ungünstig sind, da man einige Sonderzeichen wie / nicht in Datei- oder Verzeichnisnamen verwenden darf. Ein Beispiel dafür wäre als Modelbezeichnung: "5000/6000/7000". Ein Verzeichnis mit dieser Bezeichnung ist wegen den Sonderzeichen nicht gestattet. Seit der dritten Service Release opsi 4.0.3 werden deshalb folgende Sonderzeichen: < > ? " : | \ / *  intern durch ein _ ersetzt. +
 Mit dieser Änderung kann man oben genanntes schlechtes Beispiel als: "5000_6000_7000" anlegen und das Verzeichnis wird automatisch zu gewiesen, obwohl die Information in der Hardware-Inventarisierung nicht der Verzeichnisstruktur  enstprechen.

IMPORTANT: Nach einem Treiberupload nach `./drivers/drivers` oder `./drivers/drivers/preferred` sollte die `create_driver_links.py` auf dem 'opsi-Depotserver' aufgerufen werden!


[[opsi-manual-configed-softwareinventory]]
== Software-Informationen

Unter diesem Karteireiter erhalten Sie die letzten mit `swaudit` ausgelesenen Informationen über installierte Software beim Client.

.*opsi-configed*: Software-Informationen
image::opsi-configed-softwareinventory.png["*opsi-configed*: Software-Informationen", width=800, pdfwidth=80%]


[[opsi-manual-configed-logfiles]]
== Logdateien

Auf dem Reiter _Logdateien_ sind die Logdateien der Clients über den opsi-configed einsehbar.

Der Level, bis zu dem die Logeinträge sichtbar sind, kann mit einem Schieberegler variiert werden, so dass Fehler
leichter gefunden werden können. Den Regler können Sie auch mit dem Mausrad bedienen.

Dabei kann auch in den Logdateien gesucht werden (Fortsetzung der Suche mit [F3] oder [Strg]{plus}[L]).
Die einzelnen Zeilen sind je nach Loglevel farbig hervorgehoben.

.*opsi-configed*: Logdateien betrachten
image::opsi-configed-logfiles.png["*opsi-configed*: Logdateien betrachten", Software-Informationen", width=800, pdfwidth=80%]

[[opsi-manual-configed-hostproperties]]
== Host-Parameter: Client- und Server-Konfiguration

Eine ganze Reihe von Konfigurationsvorgaben können Sie über den Reiter _Host-Parameter_ vornehmen. Befinden Sie sich im Modus _Client-Konfiguration_, zeigt _Host-Parameter_ die clientspezifischen Einstellungen an. Ist hingegen die _Server-Konfiguration_ aktiv, sehen sie die jeweiligen Server-Defaults.

Konfigurationseinträge (config-Objekte des opsi-Servers) sind grundsätzlich Wertelisten.
Als Werkzeug zur Bearbeitung der Werte dient daher der Listeneditor
(vgl. <<opsi-manual-configed-property-editing>> )

Je nach Typ des jeweiligen Konfigurationsobjektes

- können die Elemente der Liste entweder Unicode-Textwerte oder boolesche Werte (`true`/`false`) sein;

- kann die Gesamtheit der zulässigen Listenelemente fest oder erweiterbar sein;

- umfasst der DefaultValues-Eintrag des Objektes  im singleValue-Fall genau ein Listenelement,
bei multiValue-Objekten eine beliebige Auswahl aus den zulässigen Listenelementen.

Neue Konfigurationseinträge können über das Kontextmenü auf der Server-Host-Parameter-Seite erstellt werden.
Ebenso können dort bestehende Objekte gelöscht werden.

.*opsi-configed*: Host-Parameter (Kontextmenü eines Client-Eintrags)
image::opsi-configed-hostparameter_setting.png["*opsi-configed*: Host-Parameter (Kontextmenü eines Client-Eintrags)", width=800, pdfwidth=80%]

Das Verhältnis von Server- und Client-Host-Parametern ist verwickelt:

- Server-Einträge liefern die Default-Werte für die Client-Einträge.

- Konsequenterweise muss, um einen Client-Eintrag zu erhalten, zuerst ein Server-Konfigurationsobjekt angelegt werden.

- Und, wenn ein Server-Eintrag (das Config-Objekt) gelöscht wird, verschwinden auch
die zugehörigen Client-Einträge (die auf ConfigState-Objekten beruhen).

- Es kann sowohl bei Abweichung des Client-Wertes vom Server-Default als auch, wenn die beiden derzeit identisch sind, einen
eigenen Eintrag des Clients in der Datenbank geben. Sofern es diesen eigenen Eintrag gibt, bleibt er auch erhalten, wenn sich der
Server-Default ändert.

- Zum Umgang mit diesem Thema gibt es daher ab configed Version 4.0.7.6.5 für die Client-Properties ein Kontextmenü
mit den beiden Optionen "Spezifischen Client-Wert entfernen" (d.h., der Clientwert ist immer der gerade aktuelle Default-Werte des Servers)
und  "Setze den jetzigen Default-Wert als (dauerhaften) Wert für den Client.

- Wenn der Client-Wert sich vom aktuellen Server-Default unterscheidet, so ist dieser fett dargestellt.

- Es kann Konfigurationsobjekte geben, für die theoretisch Client-Werte erzeugt und bearbeitet
werden können, die jedoch keinerlei Bedeutung haben, weil eigentlich nur serverbezogene Informationen gespeichert werden.
Diese Properties sind in den aktuellen configed-Versionen in der Regel ausgeblendet.

Zur besseren Übersicht sind die Host-Parameter gegliedert nach Funktionsgruppen aufgeführt.
Die Gruppen werden auf der linken Seite in einer baumartigen Struktur aufgeführt. Jeweils die zugehörigen
Parameter und ihre Werte erscheinen auf der rechten Seite.

.*opsi-configed*: Host-Parameter in der Client-Konfiguration
image::opsi-configed-hostparameters.png["*opsi-configed*: Host-Parameter in der Client-Konfiguration", width=800, pdfwidth=80%]

