////
; Copyright (c) uib gmbh (www.uib.de)
; This documentation is owned by uib
; and published under the german creative commons by-sa license
; see:
; https://creativecommons.org/licenses/by-sa/3.0/de/
; https://creativecommons.org/licenses/by-sa/3.0/de/legalcode
; english:
; https://creativecommons.org/licenses/by-sa/3.0/
; https://creativecommons.org/licenses/by-sa/3.0/legalcode
;
;
////

:Author:    uib gmbh
:Email:     info@uib.de
:Date:      06.05.2022
:Revision:  4.2
:toclevels: 6

[[opsi-select-client-hardware-general]]
=== General information

There are no lists of supported or unsupported hardware for opsi, and due to the fast pace of the market, it will not be possible to maintain such lists.

Nevertheless, some requirements should be observed when procuring client hardware. +
This is not because of specific problems with opsi, but because of the fundamental challenges of client management. +
See also: link:https://docs.opsi.org/opsi-docs-en/4.2/manual/server/temporal-job-control.html[Scheduling installations]


In general, enterprise class devices are more likely to be suitable than consumer devices.

General information on the procurement of client hardware can be found here:

* https://www.itk-beschaffung.de/EN/Guidelines/Notebooks

* https://www.itk-beschaffung.de/EN/Guidelines/PC-Desktop

[[opsi-select-client-hardware-ethernet]]
=== Ethernet / RJ45 / USB-Adapter / MacPassThrough

A wired network connection is of great importance or a necessity for many functions of client management. If possible, a client with a network adapter / RJ45 interface on the device is preferable to an adapter-based solution.

.Ethernet RJ45 connector
image::Ethernet_RJ45_connector_p1160054.jpg["Ethernet RJ45 connector", pdfwidth=20%]

(Source / License of image: https://commons.wikimedia.org/wiki/File:Ethernet_RJ45_connector_p1160054.jpg +
https://creativecommons.org/licenses/by-sa/3.0/deed.en)

* Booting from network +
No network boot without a wired network. +
Without network boot, operating system installations and some other features are not available. +
See also: +
** link:https://docs.opsi.org/opsi-docs-en/4.2/manual/products/netboot-products.html[Netboot products]

** link:https://docs.opsi.org/opsi-docs-en/4.2/manual/modules/local-image.html[opsi-local-image]

** link:https://docs.opsi.org/opsi-docs-en/4.2/manual/modules/clonezilla.html[opsi-clonezilla]

* Wake on Lan +
The possibility of starting a computer via the network usually requires a wired network.

* Bandwidth +
WLAN access points now reach remarkable bandwidths. In the case of installations on many devices on the same access point, these devices have to share the bandwidth of the access point, which in the best case leads to long installation times and, in the worst case, errors and failures. +
Therefore, wired network connections are still preferable for client management when possible.

Therefore, newly procured devices should have a wired network connection when possible. +
However, more and more devices are marketed without a cable connection. +
Should (for whatever reason) a device be obtained without Ethernet on board, a cable connection via an (USB) adapter or (USB) docking station should be possible and the following further prerequisites should be observed.

.USB-RJ45-Adapter
image::usb_ext_rj45.png["USB-RJ45-Adapter", pdfwidth=40%]

Such USB-RJ45 adapters bring the following problem: These 'adapters' are actually external network cards connected via USB. This means that the MAC address of this network interface does not identify the device but the adapter. This means that a fixed assignment of a MAC address to a device is in effect no longer possible. However, this fixed assignment is required for network booting and Wake-on-LAN.

This problem is known to the manufacturers and 'MacPassthrough' is offered as a solution for this.

.BIOS MacPassThrough
image::bios_macpassthroug.png["BIOS MacPassThrough", pdfwidth=100%]

MacPassThrough is a BIOS option:
Originally: Use of the onboard MAC
Also with a docking station +
Without Ethernet onboard: a BIOS-generated MAC will be used by the USB adapter. +
In plain language: The USB adapter should not use its own MAC-address, but the one generated by the BIOS. This is implemented in software. The BIOS must at least ensure that the network boot is processed via the device-specific network address generated by the BIOS. Opsi then takes care of the rest.


[[opsi-select-client-hardware-wol]]
=== Wake on Lan / Wake on Bios

The device should support Wake on Lan. +
Ideally, no special drivers should be necessary for this. Otherwise it can happen that a newer MS driver is loaded as part of a Microsoft update and Wake-on-LAN fails until the special driver is installed again. +
For devices without ethernet on board, the Wake-on-LAN should ideally also work via the USB-RJ45 adapter with the address provided by 'MacPassThrough'.

If there is no wired network available or if this is not connected in normal operation, it should be possible to wake the computer on days and times that can be entered in the BIOS (Wake on Bios / Wake Up Timer).

[[opsi-select-client-hardware-bios]]
=== BIOS maintenance

From the preceding it is made clear that the configuration of the BIOS is an important step in client management. Therefore, the configuration and maintenance of the BIOS should be script-controlled and non-interactive. This means that you can carry out the necessary configurations of the BIOS via an opsi-product:

* BIOS update

* Set / change BIOS password

* Switch UEFI / secure boot on / off

* Switch on Wake-on-LAN

* Switch on 'MacPassThrough'

* Switch wake timer on / off and set times

The script-controlled configuration should also be possible with the BIOS password switched on. +
Attention: Even if a script-controlled BIOS configuration is possible in principle, it does not necessarily have to include all BIOS options. Therefore, make sure that the important options are all configurable.

Technically speaking, the possibilities for the BIOS configuration are usually based on an extension of the WMI of the computer, which can then be addressed via WMI or PowerShell. +
For more details here a few links:

* https://developers.hp.com/hp-client-management/doc/client-management-script-library

* https://developers.hp.com/hp-client-management/doc/Bios-and-Device

* https://docs.lenovocdrt.com/#/tbct/tbct_top

* https://www.dell.com/support/manuals/en-us/command-configure/dellcommandconfigure_ug_4.7/

* https://www.fujitsu.com/emeia/imagesgig5/Fujitsu_DeskView_BIOS_Management_Overview_Tutorial.pdf

* https://www.configjon.com/lenovo-bios-settings-management/

* https://www.configjon.com/dell-bios-settings-management/

* https://www.configjon.com/hp-bios-settings-management/


[[opsi-select-client-hardware-mac-addresses]]
=== MAC-addresses

If you buy a larger number of devices, integration of the devices into your environment is easier if you know the MAC-addresses. Therefore, the supplier should be able to provide you with a machine-readable list of MAC-addresses.

[[opsi-select-client-hardware-ram]]
=== System memory (RAM)

For a network boot, the opsi-linux-bootimage must be loaded and started in the system memory (RAM). At least 2 GB RAM is currently required. +
For some Linux distributions (e.g. Ubuntu / Mint), 4 GB is required.

[[opsi-select-client-hardware-test]]
=== Hardware test

Before you buy a larger number of devices, it is always a good idea to request a reference device, which you can then test with opsi. You can also commission such a test from uib gmbh.


[[opsi-select-client-hardware-driver]]
=== Driver provisioning

Ideally, the manufacturer should provide model-specific driver packages on its website.
These driver packages must then be 'extract / unpacked' so that the drivers for this model can be easily made available on the opsi server. +
It is an advantage if no separate PE-driver is required for the wired network interface, so the same driver can be used in WinPE and for the installed Windows OS.

[[opsi-select-client-hardware-table]]
=== Requirements table

Wired network (RJ45):

* on board (better) or +
via USB-adapter with 'MacPassThrough' support in the BIOS

* Network boot via IPv4 / IPv6

* Wake-on-LAN support

** Also with default drivers ?

** Also for use with MacPassThrough ?

Script-controlled BIOS configuration:

* BIOS Update

* Set / change BIOS password

* Switch UEFI / secure boot on / off

* Switch on Wake-on-LAN

* Switch on 'MacPassThrough'

* Switch wake timer on / off and set times

Miscellaneous:

* Driver provisioning / extractable ?

* Driver provisioning / PE driver needed ?
 
* MAC Adress list

* Enough RAM for the bootimage (2 GB / 4 GB for Linux)


